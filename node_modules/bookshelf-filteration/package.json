{
  "name": "bookshelf-filteration",
  "version": "0.1.7",
  "description": "Bookshelf plugin that filters and validates model attributes.",
  "author": {
    "name": "Sandro Simas"
  },
  "license": "MIT",
  "keywords": [
    "bookshelf",
    "validation",
    "validator",
    "filter",
    "plugin"
  ],
  "main": "index.js",
  "scripts": {
    "test": "mocha"
  },
  "directories": {
    "lib": "lib",
    "test": "test"
  },
  "homepage": "https://github.com/sandro-csimas/bookshelf-filteration",
  "repository": {
    "type": "git",
    "url": "https://github.com/sandro-csimas/bookshelf-filteration.git"
  },
  "bugs": {
    "url": "https://github.com/sandro-csimas/bookshelf-filteration/issues"
  },
  "dependencies": {
    "bluebird": "*",
    "lodash": "*",
    "validate.js": "*"
  },
  "devDependencies": {
    "chai": "*",
    "bookshelf": "*",
    "knex": "*",
    "mysql": "*"
  },
  "readme": "# Bookshelf Filteration (Filter + Validation)\nSometimes you don't want to save all attributes of a model. There are cases that you want to save specific attributes according to scenario, for example an user update, an user creation, or when you want to force a avatar only edition. Bookshelf Filteration make it easy!\n\nBookshelf-filteration also uses validate.js to validate your model attributes with the difference that only filtered attributes will be validated.\n\n# Installation\n````\nnpm install bookshelf-filteration\n````\n\n# Configuration\nYou can set Bookshelf Filteration to use insert and update methods as filter scenarios when no scenario is provided.\n````\nvar filteration = require('bookshelf-filteration');\nfilteration.useMethodFilter(true);\nBookshelf.plugin(filteration);\n````\n\n# Filtering attributes\nYou can provide lists of attributes that will be used to do inserts or updates according to scenario provided in save options. Attributes that are not contained in the list are excluded from model and will not be inserted or updated. This list can contain Strings or Objects with name and required attributes.\nThe required attribute defines if the attribute is mandatory for that scenario and will throw ValidationError when an attribute is required, but is not present on model attributes.\n\n````\nvar User = Bookshelf.Model.extend({\n  idAttribute: 'id',\n  tableName: 'user',\n  filters: {\n    // Insert scenario (used when a model will be inserted and you configured to use method filter)\n    insert: [{name: 'first_name', required: true}, {name: 'email', required: true}, {name: 'password', required: true}, 'last_name'],\n    // Update scenario (used when a model will be updated and you configured to use method filter)\n    update: ['first_name', 'last_name', 'email', 'password', 'phone'],\n    // Custom scenario (used when passes the option scenario)\n    changeAvatar: ['avatar']\n  }\n});\n````\n\n# Validating attributes example:\nThe validation will be applied only to remaining attributes after filtering. If filters are not provided, only model attributes will be considered, in other words, not all validations declared will be used.\n\n````\nvar User = Bookshelf.Model.extend({\n  idAttribute: 'id',\n  tableName: 'user',\n  validations: {\n    first_name: {presence: true, length: {minimum: 3}},\n    last_name: {notBlank: true, length: {minimum: 3}},\n    email: {presence: true, email: true},\n    password: {presence: true, length: {minimum: 3}},\n    phone: {format: /\\+\\d{2} \\d{2} \\d{4,5}\\-\\d{4}/}\n  }\n});\n````\n- The custom validation notBlank\nValidate.js provides a lot of useful validations, but they considered that empty strings are valid values, even if an length validation with minimum length is provided. The problem is that sometimes you don't want to treat blank as valid value. Length validation is an example of this situation.\n````\nvalidate({first_name: 'Sandro', last_name: ''}, {length: {minimum: 3}});\n// [] No errors, but we expect a validation error since 0 length is less than 3.\n````\n````\nvalidate({first_name: 'Sandro', last_name: ''}, {notBlank: true, length: {minimum: 3}});\n// [\"Last name can't be blank\"] Now we have the correct behavior. You can set last_name to null, but not blank.\n````\n\n# Combining filters and validations example:\n````\nvar User = Bookshelf.Model.extend({\n  idAttribute: 'id',\n  tableName: 'user',\n  validations: {\n    first_name: {presence: true, length: {minimum: 3}},\n    last_name: {notBlank: true, length: {minimum: 3}},\n    email: {presence: true, email: true},\n    password: {presence: true, length: {minimum: 3}},\n    phone: {format: /\\+\\d{2} \\d{2} \\d{4,5}\\-\\d{4}/}\n  },\n  filters: {\n    insert: [{name: 'first_name', required: true}, {name: 'email', required: true}, {name: 'password', required: true}, 'last_name'],\n    update: ['first_name', 'last_name', 'email', 'password', 'phone'],\n    changeAvatar: ['avatar']\n  }\n});\n````",
  "readmeFilename": "README.md",
  "gitHead": "7daec734c29b0f541bc35bca6fa04914e1857c87",
  "_id": "bookshelf-filteration@0.1.7",
  "_shasum": "5ca32d3ea42d3f71db262d67646de0d706e21dcb",
  "_from": "bookshelf-filteration@0.1.7"
}
